<!-- Command Palette (‚åòK Navigation) -->
<div x-data="commandPalette()" 
     x-on:keydown.window.prevent.ctrl.k="toggle()" 
     x-on:keydown.window.prevent.meta.k="toggle()"
     x-on:keydown.escape.window="open = false"
     @toggle-command-palette.window="toggle()"
     x-show="open"
     x-cloak
     class="fixed inset-0 z-50 flex items-start justify-center pt-16 px-4 sm:pt-24"
     style="display: none;">
  
  <!-- Backdrop -->
  <div x-show="open"
       x-transition:enter="transition ease-out duration-200"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       x-transition:leave="transition ease-in duration-150"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0"
       @click="open = false"
       class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm"></div>
  
  <!-- Command Palette Modal -->
  <div x-show="open"
       x-transition:enter="transition ease-out duration-200"
       x-transition:enter-start="opacity-0 scale-95"
       x-transition:enter-end="opacity-100 scale-100"
       x-transition:leave="transition ease-in duration-150"
       x-transition:leave-start="opacity-100 scale-100"
       x-transition:leave-end="opacity-0 scale-95"
       class="relative w-full max-w-2xl bg-white dark:bg-slate-900 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 overflow-hidden">
    
    <!-- Search Input -->
    <div class="flex items-center gap-3 px-4 py-3 border-b border-slate-200 dark:border-slate-700">
      <span class="text-slate-400 dark:text-slate-500 text-xl">üîç</span>
      <input 
        x-ref="searchInput"
        x-model="search"
        @input="filterItems()"
        type="text" 
        placeholder="Type to search..." 
        class="flex-1 bg-transparent border-none outline-none text-slate-900 dark:text-slate-100 placeholder-slate-400 dark:placeholder-slate-500"
        autofocus
      />
      <kbd class="hidden sm:inline-block px-2 py-1 text-xs font-semibold text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-800 rounded">ESC</kbd>
    </div>
    
    <!-- Results -->
    <div class="max-h-96 overflow-y-auto">
      <template x-if="filteredItems.length === 0">
        <div class="px-4 py-8 text-center text-slate-500 dark:text-slate-400">
          <div class="text-4xl mb-2">ü§∑</div>
          <div>No results found</div>
        </div>
      </template>
      
      <div class="py-2">
        <template x-for="(item, index) in filteredItems" :key="index">
          <a :href="item.url"
             @click="navigate(item.url)"
             class="flex items-center gap-3 px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors cursor-pointer">
            <span class="text-2xl" x-text="item.icon"></span>
            <div class="flex-1">
              <div class="font-semibold text-slate-900 dark:text-slate-100" x-text="item.title"></div>
              <div class="text-sm text-slate-500 dark:text-slate-400" x-text="item.description"></div>
            </div>
            <kbd class="hidden sm:inline-block px-2 py-1 text-xs font-mono text-slate-400 dark:text-slate-500 bg-slate-100 dark:bg-slate-800 rounded" x-text="item.shortcut || ''"></kbd>
          </a>
        </template>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="flex items-center justify-between px-4 py-2 text-xs text-slate-500 dark:text-slate-400 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50">
      <div class="flex items-center gap-2">
        <kbd class="px-2 py-1 bg-white dark:bg-slate-800 rounded">‚åòK</kbd>
        <span>or</span>
        <kbd class="px-2 py-1 bg-white dark:bg-slate-800 rounded">Ctrl K</kbd>
        <span>to toggle</span>
      </div>
      <div class="flex items-center gap-2">
        <kbd class="px-2 py-1 bg-white dark:bg-slate-800 rounded">‚Üë‚Üì</kbd>
        <span>to navigate</span>
        <kbd class="px-2 py-1 bg-white dark:bg-slate-800 rounded">‚Üµ</kbd>
        <span>to select</span>
      </div>
    </div>
  </div>
</div>

<script>
  function commandPalette() {
    return {
      open: false,
      search: '',
      items: [
        // Navigation
        { icon: 'üè†', title: 'Home', description: 'Return to homepage', url: '/' },
        { icon: 'üë§', title: 'About', description: 'Learn about WCNegentropy', url: '/#about' },
        { icon: 'üöÄ', title: 'Projects', description: 'View research projects', url: '/#projects' },
        { icon: 'üí¨', title: 'Contact', description: 'Get in touch', url: '/#contact' },
        { icon: 'üîó', title: 'Links', description: 'Social media and profiles', url: '/#links' },
        
        // Projects
        { icon: 'ü§ñ', title: 'BitTransformerLM', description: 'Binary transformer architecture', url: 'https://huggingface.co/WCNegentropy/BitTransformerLM' },
        { icon: 'üåä', title: 'WrinkleBrane', description: 'Wave interference transformer', url: 'https://huggingface.co/WCNegentropy/WrinkleBrane' },
        
        // External
        { icon: 'üêô', title: 'GitHub', description: 'Open source repositories', url: 'https://github.com/WCNegentropy' },
        { icon: 'ü§ó', title: 'HuggingFace', description: 'AI models and research', url: 'https://huggingface.co/WCNegentropy' },
        { icon: 'ùïè', title: 'X / Twitter', description: 'Updates and thoughts', url: 'https://x.com/WCNegentropy' },
        { icon: 'ü§ñ', title: 'Reddit', description: 'Community discussions', url: 'https://reddit.com/user/WCNegentropy' },
        
        // Pages
        { icon: 'üìÑ', title: 'Privacy Policy', description: 'How we handle your data', url: '/privacy' },
        { icon: 'üìã', title: 'Terms of Service', description: 'Legal terms and conditions', url: '/terms' },
      ],
      filteredItems: [],
      
      init() {
        this.filteredItems = this.items;
      },
      
      toggle() {
        this.open = !this.open;
        if (this.open) {
          this.$nextTick(() => {
            this.$refs.searchInput.focus();
          });
        }
      },
      
      filterItems() {
        const query = this.search.toLowerCase().trim();
        
        if (!query) {
          this.filteredItems = this.items;
          return;
        }
        
        this.filteredItems = this.items.filter(item => {
          return item.title.toLowerCase().includes(query) ||
                 item.description.toLowerCase().includes(query);
        });
      },
      
      navigate(url) {
        if (url.startsWith('http')) {
          window.open(url, '_blank', 'noopener,noreferrer');
        } else {
          window.location.href = url;
        }
        this.open = false;
        this.search = '';
      }
    };
  }
</script>

<style>
  [x-cloak] {
    display: none !important;
  }
</style>
